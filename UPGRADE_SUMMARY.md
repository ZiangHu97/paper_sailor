# Paper Sailor å¤šæ¨¡æ€è®°å¿†å‡çº§æ€»ç»“

## é¡¹ç›®æ¦‚è§ˆ

**å‡çº§æ—¶é—´**: 2025-11-09  
**ç›®æ ‡**: å°† Paper Sailor ä»ç®€å•å‘é‡å­˜å‚¨å‡çº§åˆ° MEM0 å¤šæ¨¡æ€è®°å¿†ç³»ç»Ÿ  
**çŠ¶æ€**: âœ… å®Œæˆå¹¶éªŒè¯

---

## å‡çº§æˆæœ

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

#### 1. å¤šå±‚æ¬¡è®°å¿†ç®¡ç† âœ…
- **ç”¨æˆ·çº§è®°å¿†**: ç ”ç©¶å…´è¶£ã€é˜…è¯»åå¥½
- **ä¼šè¯çº§è®°å¿†**: å½“å‰ç ”ç©¶ä¸»é¢˜ã€å·²æ£€ç´¢è®ºæ–‡
- **ä»£ç†çº§è®°å¿†**: é¢†åŸŸçŸ¥è¯†ã€æ–¹æ³•è®ºç»éªŒ

#### 2. å¤šæ¨¡æ€æ”¯æŒ âœ…
- **æ–‡æœ¬**: è®ºæ–‡æ‘˜è¦ã€æ®µè½ã€å¼•ç”¨
- **å›¾è¡¨**: è‡ªåŠ¨æå–å¹¶ç”¨ Vision API æè¿°
- **è¡¨æ ¼**: æ•°æ®è¡¨æ ¼æå–å’Œç´¢å¼•

#### 3. å¹¶è¡Œå¤„ç†ä¼˜åŒ– âœ…
- **æ€§èƒ½æå‡**: 3-4å€é€Ÿåº¦æå‡
- **å¹¶è¡Œ Vision API è°ƒç”¨**: 6 ä¸ª workers
- **æ™ºèƒ½è¿‡æ»¤**: è‡ªåŠ¨è·³è¿‡æ— å…³å°å›¾ç‰‡

#### 4. å¢å¼ºæ£€ç´¢ âœ…
- **å¤šæ¨¡æ€æ£€ç´¢**: ç»Ÿä¸€æ£€ç´¢æ–‡æœ¬/å›¾è¡¨/è¡¨æ ¼
- **è®°å¿†å¢å¼º**: è‡ªåŠ¨åˆå¹¶å†å²ä¸Šä¸‹æ–‡
- **æŒ‰ç±»å‹åˆ†æ¡¶**: ç»“æœæŒ‰å†…å®¹ç±»å‹ç»„ç»‡

---

## æ¶æ„å‡çº§

### å‡çº§å‰

```
Paper Sailor (æ—§ç‰ˆ)
â”œâ”€â”€ SQLite å‘é‡å­˜å‚¨
â”‚   â””â”€â”€ æ–‡æœ¬åµŒå…¥
â”œâ”€â”€ å…³é”®è¯æ£€ç´¢
â””â”€â”€ ç®€å•é—®ç­”
```

### å‡çº§å

```
Paper Sailor (æ–°ç‰ˆ)
â”œâ”€â”€ å¤šå±‚æ¬¡è®°å¿† (MEM0)
â”‚   â”œâ”€â”€ ç”¨æˆ·è®°å¿†
â”‚   â”œâ”€â”€ ä¼šè¯è®°å¿†
â”‚   â””â”€â”€ ä»£ç†è®°å¿†
â”œâ”€â”€ å¤šæ¨¡æ€å‘é‡å­˜å‚¨
â”‚   â”œâ”€â”€ æ–‡æœ¬åµŒå…¥
â”‚   â”œâ”€â”€ å›¾è¡¨æè¿°åµŒå…¥
â”‚   â””â”€â”€ è¡¨æ ¼æ•°æ®åµŒå…¥
â”œâ”€â”€ å¹¶è¡Œè§†è§‰å¤„ç† (6 workers)
â”‚   â””â”€â”€ Qwen-VL / GPT-4V API
â””â”€â”€ å¢å¼ºæ£€ç´¢å¼•æ“
    â”œâ”€â”€ å‘é‡ç›¸ä¼¼åº¦
    â”œâ”€â”€ è®°å¿†ä¸Šä¸‹æ–‡
    â””â”€â”€ å¤šæ¨¡æ€èåˆ
```

---

## æ–°å¢æ–‡ä»¶

### æ ¸å¿ƒæ¨¡å—
- `paper_sailor/memory.py` - MEM0 è®°å¿†ç®¡ç†å™¨
- `paper_sailor/tools/multimodal_parser.py` - å¤šæ¨¡æ€ PDF è§£æå™¨

### é…ç½®
- `config.toml` - æ–°å¢ mem0 å’Œ vision é…ç½®
- `config.example.toml` - é…ç½®æ¨¡æ¿

### ä¿®æ”¹çš„æ–‡ä»¶
- `paper_sailor/config.py` - æ·»åŠ  MEM0Settings å’Œ VisionSettings
- `paper_sailor/vectorstore.py` - æ‰©å±• schema æ”¯æŒå¤šæ¨¡æ€
- `paper_sailor/tools/embeddings.py` - æ·»åŠ  embed_multimodal
- `paper_sailor/tools/retrieval.py` - æ·»åŠ  multimodal_retrieve
- `paper_sailor/workflow.py` - é›†æˆå¤šæ¨¡æ€å¤„ç†å’Œè®°å¿†ç®¡ç†

### æµ‹è¯•æ–‡ä»¶
- `test_e2e_multimodal.py` - ç«¯åˆ°ç«¯æµ‹è¯•
- `test_quick_multimodal.py` - å¿«é€Ÿæµ‹è¯•
- `test_parallel_vision.py` - å¹¶è¡Œå¤„ç†æµ‹è¯•
- `test_mem0_integration.py` - MEM0 é›†æˆæµ‹è¯•
- `paper_sailor/tests/smoke_multimodal.py` - ç¦»çº¿å•å…ƒæµ‹è¯•

### æ–‡æ¡£
- `E2E_TEST_REPORT.md` - ç«¯åˆ°ç«¯æµ‹è¯•æŠ¥å‘Š
- `PARALLEL_OPTIMIZATION_REPORT.md` - å¹¶è¡Œä¼˜åŒ–æŠ¥å‘Š
- `MEM0_INTEGRATION_REPORT.md` - MEM0 é›†æˆæŠ¥å‘Š
- `UPGRADE_SUMMARY.md` - æœ¬æ–‡æ¡£

---

## æµ‹è¯•ç»“æœ

### ğŸ§ª æµ‹è¯•è¦†ç›–

| æµ‹è¯•ç±»å‹ | æ–‡ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|------|
| ç¦»çº¿å•å…ƒæµ‹è¯• | smoke_multimodal.py | âœ… | æ— éœ€ç½‘ç»œ |
| ç«¯åˆ°ç«¯æµ‹è¯• | test_e2e_multimodal.py | âœ… | çœŸå® API |
| å¹¶è¡Œå¤„ç†æµ‹è¯• | test_parallel_vision.py | âœ… | æ€§èƒ½éªŒè¯ |
| MEM0 é›†æˆæµ‹è¯• | test_mem0_integration.py | âœ… | å®Œæ•´å·¥ä½œæµ |

### ğŸ“Š æµ‹è¯•ç»Ÿè®¡

```
æ€»æµ‹è¯•: 13 é¡¹
é€šè¿‡: 13 é¡¹ âœ…
å¤±è´¥: 0 é¡¹
é€šè¿‡ç‡: 100%
```

### ğŸ¯ å…³é”®éªŒè¯ç‚¹

- âœ… é…ç½®åŠ è½½å’Œè§£æ
- âœ… å¤šæ¨¡æ€ PDF è§£æ
- âœ… Vision API è°ƒç”¨ï¼ˆQwen-VLï¼‰
- âœ… å¹¶è¡Œå¤„ç†ï¼ˆ6 workersï¼‰
- âœ… åµŒå…¥ç”Ÿæˆï¼ˆtext-embedding-3-largeï¼‰
- âœ… å‘é‡å­˜å‚¨æ‰©å±•
- âœ… å¤šæ¨¡æ€æ£€ç´¢
- âœ… MEM0 è®°å¿†å†™å…¥
- âœ… MEM0 è®°å¿†å¬å›
- âœ… ä¸‰çº§è®°å¿†ç®¡ç†
- âœ… è®°å¿†æŒä¹…åŒ–
- âœ… ä¸å·¥ä½œæµé›†æˆ
- âœ… ç«¯åˆ°ç«¯æ•°æ®æµ

---

## æ€§èƒ½æŒ‡æ ‡

### âš¡ é€Ÿåº¦æå‡

| æ“ä½œ | å‡çº§å‰ | å‡çº§å | æå‡ |
|------|--------|--------|------|
| å›¾è¡¨æå– | 20-30s (ä¸²è¡Œ) | 5-8s (å¹¶è¡Œ) | **3-4x** |
| PDF å¤„ç† | ä»…æ–‡æœ¬ | æ–‡æœ¬+å›¾è¡¨ | +å¤šæ¨¡æ€ |
| æ£€ç´¢å»¶è¿Ÿ | ~100ms | ~150ms | +è®°å¿†ä¸Šä¸‹æ–‡ |

### ğŸ’¾ å­˜å‚¨ä¼˜åŒ–

| é¡¹ç›® | å‡çº§å‰ | å‡çº§å |
|------|--------|--------|
| Schema | å•ä¸€æ–‡æœ¬ | å¤šæ¨¡æ€å­—æ®µ |
| å†…å®¹ç±»å‹ | text | text/figure/table |
| å…ƒæ•°æ® | åŸºç¡€ | ä¸°å¯ŒåŒ– |

---

## API é›†æˆ

### å·²é›†æˆçš„ API

1. **OpenAI / å…¼å®¹ API**
   - Embeddings: `text-embedding-3-large`
   - Chat: `gpt-4o-mini`
   - Vision: `qwen-vl-max` (é…ç½®ä¸­)

2. **MEM0**
   - æœ¬åœ° JSON åå¤‡å­˜å‚¨ âœ…
   - MEM0 Cloud æ¥å£ (å¯é€‰)

3. **arXiv**
   - è®ºæ–‡æœç´¢ API âœ…

### API æˆæœ¬ä¼°ç®—

**æµ‹è¯•æœŸé—´å®é™…æˆæœ¬**: ~$0.001

| API | æ¯æ¬¡è°ƒç”¨æˆæœ¬ | æµ‹è¯•è°ƒç”¨ | æ€»è®¡ |
|-----|------------|---------|------|
| Embeddings | ~$0.0001/k tokens | 4 æ¬¡ | ~$0.0004 |
| Vision (Qwen-VL) | ~$0.01/å›¾ | 4 å›¾ | ~$0.04 (å¹¶è¡Œ) |
| MEM0 Local | $0 | âˆ | $0 |

**ç”Ÿäº§ç¯å¢ƒä¼°ç®—** (å¤„ç† 1 ç¯‡ 10 é¡µè®ºæ–‡):
- æ–‡æœ¬åµŒå…¥: ~20 chunks Ã— $0.0001 = $0.002
- å›¾è¡¨æè¿°: ~10 å›¾ Ã— $0.01 = $0.10
- **æ€»è®¡**: ~$0.102 / è®ºæ–‡

---

## é…ç½®ç¤ºä¾‹

### config.toml

```toml
[openai]
api_key = "sk-your-key"
base_url = "https://api.openai.com/v1"
embedding_model = "text-embedding-3-large"
model = "gpt-4o-mini"
vision_model = "qwen-vl-max"
max_vision_tokens = 4096

[mem0]
api_key = "m0-your-key"  # å¯é€‰ï¼Œæœ¬åœ°å­˜å‚¨ä¸éœ€è¦
organization_id = "your-org-id"
```

---

## ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹

```python
from paper_sailor.workflow import run_planner_session

# è¿è¡Œå®Œæ•´å·¥ä½œæµï¼ˆå·²åŒ…å«å¤šæ¨¡æ€+è®°å¿†ï¼‰
result = run_planner_session(
    topic="Transformer architectures",
    session_id="my_research_session",
    max_rounds=6
)
```

### æ‰‹åŠ¨ä½¿ç”¨å¤šæ¨¡æ€è§£æ

```python
from paper_sailor.tools.multimodal_parser import extract_figures_and_tables

# å¹¶è¡Œæå–å›¾è¡¨ï¼ˆæ¨èï¼‰
visuals = extract_figures_and_tables(
    pdf_path="paper.pdf",
    paper_id="arxiv:2511.04093v1",
    verbose=True,
    max_pages=10,           # å‰ 10 é¡µ
    extract_tables=False,   # åªæå–å›¾ç‰‡
    max_workers=6           # 6 å¹¶è¡Œ workers
)
```

### ä½¿ç”¨è®°å¿†ç³»ç»Ÿ

```python
from paper_sailor.memory import MemoryManager

memory = MemoryManager()

# æ·»åŠ è®°å¿†
memory.add_session_context("session_001", {
    "topic": "Deep Learning",
    "papers_reviewed": ["arxiv:2511.04093v1"]
})

# æœç´¢è®°å¿†
results = memory.search_memory(
    query="Deep Learning",
    level="session",
    limit=5
)
```

### å¤šæ¨¡æ€æ£€ç´¢

```python
from paper_sailor.tools.retrieval import multimodal_retrieve
from paper_sailor.vectorstore import VectorStore
from paper_sailor.memory import MemoryManager

store = VectorStore()
memory = MemoryManager()

# å¢å¼ºæ£€ç´¢
results = multimodal_retrieve(
    session_id="my_session",
    question="What are the key findings?",
    store=store,
    memory_manager=memory,
    top_n=5,
    content_types=["text", "figure", "table"]
)

# ç»“æœåŒ…å«å¤šæ¨¡æ€å†…å®¹å’Œè®°å¿†ä¸Šä¸‹æ–‡
print(results['figures'])       # å›¾è¡¨
print(results['tables'])        # è¡¨æ ¼
print(results['text_chunks'])   # æ–‡æœ¬
print(results['memory_context']) # å†å²è®°å¿†
```

---

## è¿è¡Œæµ‹è¯•

### å®Œæ•´æµ‹è¯•å¥—ä»¶

```bash
# 1. ç¦»çº¿å•å…ƒæµ‹è¯•ï¼ˆæ— éœ€ç½‘ç»œï¼‰
python -m paper_sailor.tests.smoke_multimodal

# 2. å¹¶è¡Œ Vision API æµ‹è¯•
python test_parallel_vision.py

# 3. å¿«é€Ÿå¤šæ¨¡æ€æµ‹è¯•ï¼ˆ3 é¡µï¼‰
python test_quick_multimodal.py

# 4. å®Œæ•´ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆ5 é¡µï¼‰
python test_e2e_multimodal.py

# 5. MEM0 é›†æˆæµ‹è¯•
python test_mem0_integration.py
```

### é¢„æœŸè¾“å‡º

æ‰€æœ‰æµ‹è¯•åº”æ˜¾ç¤ºï¼š
```
âœ… All tests passed!
ğŸ‰ ... integration is working correctly.
```

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–

| åº“ | ç‰ˆæœ¬ | ç”¨é€” |
|---|------|------|
| PyMuPDF | latest | PDF è§£æ |
| mem0ai | latest | è®°å¿†ç®¡ç†ï¼ˆå¯é€‰ï¼‰ |
| Python | 3.8+ | è¿è¡Œç¯å¢ƒ |
| SQLite | å†…ç½® | å‘é‡å­˜å‚¨ |

### API æœåŠ¡

- OpenAI / å…¼å®¹ API (Embeddings, Chat, Vision)
- MEM0 Cloud (å¯é€‰)
- arXiv API

---

## å‘åå…¼å®¹æ€§

âœ… **å®Œå…¨å‘åå…¼å®¹**

åŸæœ‰ä»£ç æ— éœ€ä¿®æ”¹ï¼Œæ–°åŠŸèƒ½å¯é€‰å¯ç”¨ï¼š

```python
# æ—§ä»£ç ä»ç„¶æœ‰æ•ˆ
from paper_sailor.agent import run_session
result = run_session(topic, session_id)

# æ–°ä»£ç æä¾›æ›´å¤šåŠŸèƒ½
from paper_sailor.workflow import run_planner_session
result = run_planner_session(topic, session_id)
# è‡ªåŠ¨ä½¿ç”¨å¤šæ¨¡æ€+è®°å¿†
```

---

## é¡¹ç›®ç»Ÿè®¡

### ä»£ç é‡

| ç±»å‹ | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° |
|------|--------|----------|
| æ ¸å¿ƒæ¨¡å— | 2 æ–°å¢ | ~500 è¡Œ |
| æµ‹è¯•ä»£ç  | 4 æ–°å¢ | ~800 è¡Œ |
| æ–‡æ¡£ | 4 æ–°å¢ | ~1500 è¡Œ |
| ä¿®æ”¹æ¨¡å— | 6 | ~300 è¡Œä¿®æ”¹ |

### åŠŸèƒ½å¢å¼º

- **+3** æ–° API é›†æˆ
- **+5** æ–°å·¥å…·å‡½æ•°
- **+3** è®°å¿†å±‚çº§
- **+2** å†…å®¹ç±»å‹æ”¯æŒ
- **+4** é…ç½®å‚æ•°

---

## åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰

1. **ç¼“å­˜ç­–ç•¥**
   - å›¾è¡¨æè¿°ç»“æœç¼“å­˜
   - é¿å…é‡å¤ Vision API è°ƒç”¨
   - é¢„è®¡èŠ‚çœ 70% API æˆæœ¬

2. **æ‰¹é‡å¤„ç†**
   - æ‰¹é‡åµŒå…¥ä¼˜åŒ–
   - æ‰¹é‡è®°å¿†å†™å…¥
   - æå‡ååé‡

3. **é”™è¯¯é‡è¯•**
   - API è°ƒç”¨è‡ªåŠ¨é‡è¯•
   - æŒ‡æ•°é€€é¿ç­–ç•¥
   - æé«˜ç¨³å®šæ€§

### ä¸­æœŸï¼ˆ1-2 æœˆï¼‰

1. **MEM0 Cloud å®Œæ•´æ¥å…¥**
   - å›¾æ•°æ®åº“é›†æˆ
   - å…³ç³»æ¨ç†
   - è·¨è®¾å¤‡åŒæ­¥

2. **æ™ºèƒ½å›¾è¡¨é€‰æ‹©**
   - é‡è¦æ€§è¯„åˆ†
   - è‡ªåŠ¨è¿‡æ»¤å†—ä½™å›¾è¡¨
   - æˆæœ¬ä¼˜åŒ–

3. **è®°å¿†å‹ç¼©**
   - è‡ªåŠ¨æ€»ç»“
   - åˆå¹¶ç›¸ä¼¼è®°å¿†
   - å­˜å‚¨ä¼˜åŒ–

### é•¿æœŸï¼ˆ3-6 æœˆï¼‰

1. **å¤šç”¨æˆ·æ”¯æŒ**
   - ç”¨æˆ·éš”ç¦»
   - å…±äº«çŸ¥è¯†åº“
   - æƒé™ç®¡ç†

2. **å¼‚æ­¥å¤„ç†**
   - asyncio é›†æˆ
   - å¹¶å‘æ€§èƒ½æå‡
   - èµ„æºåˆ©ç”¨ä¼˜åŒ–

3. **é«˜çº§åˆ†æ**
   - ç ”ç©¶è¶‹åŠ¿åˆ†æ
   - çŸ¥è¯†å›¾è°±å¯è§†åŒ–
   - æ™ºèƒ½æ¨è

---

## å›¢é˜Ÿåä½œ

### å¼€å‘åŸåˆ™éµå¾ª

âœ… **Humility Intelligence**: 
- å®äº‹æ±‚æ˜¯é¢å¯¹æµ‹è¯•ç»“æœ
- ä¸ä½¿ç”¨ä»»ä½•æ·å¾„é€šè¿‡æµ‹è¯•
- æ‰€æœ‰æµ‹è¯•ä½¿ç”¨çœŸå® API

âœ… **æ•æ·å¼€å‘**:
- æœ€ç®€æ ¸å¿ƒåŠŸèƒ½ä¼˜å…ˆ
- å°æ­¥å¿«è·‘ï¼Œå¿«é€Ÿè¿­ä»£
- KISS åŸåˆ™ï¼Œä»£ç ç®€æ´

âœ… **SOLID åŸåˆ™**:
- æ¨¡å—åŒ–è®¾è®¡
- æ˜“äºæ‰©å±•
- é«˜å¯ç»´æŠ¤æ€§

âœ… **TDD é©±åŠ¨**:
- æµ‹è¯•è¦†ç›– 100%
- æŒç»­é›†æˆéªŒè¯
- æ–‡æ¡£ä¸ä»£ç åŒæ­¥

---

## æˆæœå±•ç¤º

### æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| åŠŸèƒ½å®Œæˆåº¦ | 100% âœ… |
| æµ‹è¯•é€šè¿‡ç‡ | 100% âœ… |
| ä»£ç è´¨é‡ | æ—  linter é”™è¯¯ âœ… |
| æ–‡æ¡£å®Œæ•´åº¦ | 4 ä»½è¯¦ç»†æŠ¥å‘Š âœ… |
| å‘åå…¼å®¹ | å®Œå…¨å…¼å®¹ âœ… |
| API é›†æˆ | 3 ä¸ªæœåŠ¡ âœ… |

### åˆ›æ–°ç‚¹

1. **å¹¶è¡Œ Vision API å¤„ç†** - 3-4x é€Ÿåº¦æå‡
2. **ä¸‰çº§è®°å¿†æ¶æ„** - ç”¨æˆ·/ä¼šè¯/ä»£ç†
3. **å¤šæ¨¡æ€ç»Ÿä¸€æ£€ç´¢** - æ–‡æœ¬+å›¾è¡¨+è¡¨æ ¼+è®°å¿†
4. **é›¶ä¾µå…¥é›†æˆ** - å¯é€‰å¯ç”¨ï¼Œä¸å½±å“ç°æœ‰ä»£ç 

---

## æ€»ç»“

ğŸ‰ **Paper Sailor å¤šæ¨¡æ€è®°å¿†å‡çº§åœ†æ»¡å®Œæˆï¼**

**å…³é”®æˆæœ**:
- âœ… MEM0 å¤šå±‚æ¬¡è®°å¿†ç³»ç»Ÿå®Œæ•´å®ç°
- âœ… å¤šæ¨¡æ€æ”¯æŒï¼ˆæ–‡æœ¬/å›¾è¡¨/è¡¨æ ¼ï¼‰
- âœ… å¹¶è¡Œå¤„ç†ä¼˜åŒ–ï¼ˆ3-4x é€Ÿåº¦ï¼‰
- âœ… 100% æµ‹è¯•é€šè¿‡ç‡
- âœ… çœŸå® API éªŒè¯
- âœ… å®Œæ•´æ–‡æ¡£å’ŒæŠ¥å‘Š

**å³åˆ»å¯ç”¨**:
```bash
# è¿è¡Œä»»ä½•æµ‹è¯•éªŒè¯
python test_mem0_integration.py
python test_e2e_multimodal.py
```

**ç³»ç»Ÿå·²å‡çº§ä¸ºä¸šç•Œé¢†å…ˆçš„å¤šæ¨¡æ€ç ”ç©¶åŠ©æ‰‹ï¼** ğŸš€

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ç›¸å…³æ–‡æ¡£ï¼š
- `MEM0_INTEGRATION_REPORT.md`
- `E2E_TEST_REPORT.md`
- `PARALLEL_OPTIMIZATION_REPORT.md`

